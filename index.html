<!doctype html>
<html>
	<head>
		<script src="/socket.io/socket.io.js"></script>
		<script src="/client/vector.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
		<style>
			html, body, canvas {width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden}
		</style>

		<title>Test</title>
	</head>
	<body>
		Testing123
		<canvas id="canvas">Wat</canvas>
		<script>
			//Get canvas stuff
			var canvas = $('#canvas').get(0);

			$(window).resize(function(){
				width = canvas.width = $(canvas).width();
				height = canvas.height = $(canvas).height();
			}).resize();

			var ctx = canvas.getContext('2d');
			var position = new Vector(10, 10);


			var keycodes = {
				up:    87,
				down:  83,
				left:  65,
				right: 68
			};

			var theForce = Vector.zero();

			$(window).keydown(function(e) {
				var a = 100;
				var changed = false;
				if(keycodes.up    == e.which) changed = true, theForce.y = -a;
				if(keycodes.down  == e.which) changed = true, theForce.y = a;
				if(keycodes.left  == e.which) changed = true, theForce.x = -a;
				if(keycodes.right == e.which) changed = true, theForce.x = a;
				if(changed) socket.emit('playercontrol', theForce);
			}).keyup(function(e) {
				var changed = false;
				if(keycodes.up    == e.which) changed = true, theForce.y = 0;
				if(keycodes.down  == e.which) changed = true, theForce.y = 0;
				if(keycodes.left  == e.which) changed = true, theForce.x = 0;
				if(keycodes.right == e.which) changed = true, theForce.x = 0;
				if(changed) socket.emit('playercontrol', theForce);
			})

			var socket = io.connect('http://42nd.org:8090');
			socket.emit('set-name', prompt('name?'));
			socket.on('update', function (v) {
				ctx.fillStyle = "red";
				ctx.fillRect(v.x, v.y, 50, 50);
			});
		</script>
	</body>
</html>